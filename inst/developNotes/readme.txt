See figure XX for an overview of the processing.

For usage see test cases in ./inst/tests
and vignettes in ./vignettes